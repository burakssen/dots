!function(){var e={391:function(e){var t=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof y?t:y,i=Object.create(o.prototype),a=new O(n||[]);return i._invoke=function(e,t,r){var n=f;return function(o,i){if(n===v)throw new Error("Generator is already running");if(n===p){if("throw"===o)throw i;return R()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=C(a,r);if(c){if(c===h)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=v;var u=s(e,t,r);if("normal"===u.type){if(n=r.done?p:d,u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=p,r.method="throw",r.arg=u.arg)}}}(e,r,a),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var f="suspendedStart",d="suspendedYield",v="executing",p="completed",h={};function y(){}function m(){}function g(){}var S={};u(S,i,(function(){return this}));var w=Object.getPrototypeOf,b=w&&w(w(x([])));b&&b!==r&&n.call(b,i)&&(S=b);var k=g.prototype=y.prototype=Object.create(S);function E(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function r(o,i,a,c){var u=s(e[o],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,c)}))}c(u.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}}function C(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,C(e,r),"throw"===r.method))return h;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var o=s(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,h;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function x(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}return{next:R}}function R(){return{value:t,done:!0}}return m.prototype=g,u(k,"constructor",g),u(g,"constructor",m),m.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},E(T.prototype),u(T.prototype,a,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(k),u(k,c,"Generator"),u(k,i,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=x,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),D(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:x(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),h}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},39:function(e,t,r){e.exports=r(391)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";function e(e,t,r,n,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,o)}function t(t){return function(){var r=this,n=arguments;return new Promise((function(o,i){var a=t.apply(r,n);function c(t){e(a,o,i,c,u,"next",t)}function u(t){e(a,o,i,c,u,"throw",t)}c(void 0)}))}}var n=r(39),o=r.n(n);function i(e){return!e||!e.trim()}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var f,d,v=function(){function e(){a(this,e)}var r,n;return u(e,null,[{key:"Sleep",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}},{key:"WaitForCondition",value:(n=t(o().mark((function t(r,n){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=(new Date).getTime();case 2:return t.next=4,r();case 4:if(t.t0=!t.sent,!t.t0){t.next=7;break}t.t0=i+n>(new Date).getTime();case 7:if(!t.t0){t.next=12;break}return t.next=10,e.Sleep(100);case 10:t.next=2;break;case 12:return t.next=15,r();case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t)}))),function(e,t){return n.apply(this,arguments)})},{key:"WaitForSyncCondition",value:(r=t(o().mark((function t(r,n){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=(new Date).getTime();case 2:if(!(i+n>(new Date).getTime())){t.next=9;break}if(!r()){t.next=5;break}return t.abrupt("return",!0);case 5:return t.next=7,e.Sleep(100);case 7:t.next=2;break;case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)}))),function(e,t){return r.apply(this,arguments)})},{key:"IsValidDataField",value:function(e){return null!=e&&e.length>0&&"null"!==e}},{key:"IsOnPage",value:function(t,r){if(e.IsValidDataField(t)){var n,o=t.toLowerCase().replace(/\s+/g,"").split(","),i=r.toLowerCase(),a=!1,c=l(o);try{for(c.s();!(n=c.n()).done;){var u=n.value;if(i.indexOf(u)>=0){a=!0;break}}}catch(e){c.e(e)}finally{c.f()}return a}return!1}}]),e}(),p=v;!function(e){e.GET_TRACKING_PAGE_DATA="GetTrackingPageData",e.INVALID_TRACKING_PAGE_ERROR="InvalidTrackingPageError",e.TRACKING_PAGE_DATA="TrackingPageData",e.TRACKING_PAGE_ERROR="TrackingPageError",e.TRACKING_PAGE_PARSING_ERROR="TrackingPageParsingError",e.TRACKING_PAGE_SCRIPT_ERROR="TrackingPageScriptError"}(f||(f={})),function(e){e.ORDERED="Ordered",e.SHIPPED="Shipped",e.DELIVERED="Delivered",e.RETURNED="Returned",e.CANCELED="Canceled",e.ERROR="Error"}(d||(d={}));function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function S(e,t){if(t&&("object"===g(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function k(e,t,r){return k=b()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&y(o,r.prototype),o},k.apply(null,arguments)}function E(e){var t="function"==typeof Map?new Map:void 0;return E=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return k(e,arguments,w(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),y(n,e)},E(e)}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return S(this,r)}}var C=function(e){m(r,e);var t=T(r);function r(e){var n;return a(this,r),n=t.call(this,e),Object.setPrototypeOf(h(n),r.prototype),n}return u(r)}(E(Error));function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var D=u((function e(){a(this,e),P(this,"transactionIdSelector",void 0),P(this,"purchaseTotalSelector",void 0),P(this,"numItemsSelector",void 0),P(this,"productDetailsData",void 0),P(this,"orderIdSelectors",void 0)})),O=u((function e(){a(this,e),P(this,"productIdSelector",void 0),P(this,"productIdSkuSelector",void 0),P(this,"productPriceSelector",void 0),P(this,"productQuantitySelector",void 0),P(this,"orderSubTotalPriceSelector",void 0),P(this,"orderDiscountPriceSelector",void 0),P(this,"orderDiscountCodeSelector",void 0),P(this,"orderShippingPriceSelector",void 0),P(this,"orderTaxesPriceSelector",void 0)}));function x(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var I=function(){function e(){a(this,e),P(this,"domainName",void 0),P(this,"orderConfirmationPageUrl",void 0),P(this,"orderConfirmationRegex",void 0),P(this,"confirmationPageTelemetry",void 0),P(this,"orderDetailsPageUrl",void 0),P(this,"productNameSelector",void 0)}return u(e,null,[{key:"Create",value:function(t){var r=new e;return r.domainName=t.domainName,r.orderConfirmationPageUrl=t.orderConfirmationPageUrl,r.orderConfirmationRegex=t.orderConfirmationRegex,r.orderDetailsPageUrl=t.orderDetailsPageUrl,r.productNameSelector=t.productNameSelector,t&&t.confirmationPageTelemetry&&(r.confirmationPageTelemetry=this.CreateConfirmationPageTelemetryData(t.confirmationPageTelemetry)),r}},{key:"CreateConfirmationPageTelemetryData",value:function(e){var t=new D;return t.purchaseTotalSelector=e.purchaseTotalSelector,t.transactionIdSelector=e.transactionIdSelector,t.numItemsSelector=e.numItemsSelector,t.orderIdSelectors=e.orderIdSelectors,e&&e.productDetailsData&&(t.productDetailsData=this.CreateProductDetailsData(e.productDetailsData)),t}},{key:"CreateProductDetailsData",value:function(e){var t,r=[],n=x(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o){var i=new O;i.productIdSelector=o.productIdSelector,i.productIdSkuSelector=o.productIdSkuSelector,i.productPriceSelector=o.productPriceSelector,i.productQuantitySelector=o.productQuantitySelector,i.orderDiscountCodeSelector=o.orderDiscountCodeSelector,i.orderDiscountPriceSelector=o.orderDiscountPriceSelector,i.orderShippingPriceSelector=o.orderShippingPriceSelector,i.orderSubTotalPriceSelector=o.orderSubTotalPriceSelector,i.orderTaxesPriceSelector=o.orderTaxesPriceSelector,r.push(i)}}}catch(e){n.e(e)}finally{n.f()}return r}}]),e}(),N=u((function e(){a(this,e),P(this,"retailerData",void 0),P(this,"impressionId",void 0),P(this,"cashback",void 0)}));function A(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var L=function(){function e(){a(this,e)}return u(e,null,[{key:"RunQuerySelectorAll",value:function(e){var t,r=e.split("<"),n=document.querySelectorAll(r[0]),o=A(r.slice(1));try{for(o.s();!(t=o.n()).done;){var i,a=t.value,c=null===(i=n[0])||void 0===i?void 0:i.shadowRoot;if(!c)return[];n=c.querySelectorAll(a)}}catch(e){o.e(e)}finally{o.f()}return n}},{key:"GetElementsByClass",value:function(e){return e&&""!==e?document.getElementsByClassName(e):[]}},{key:"CreateRetailerData",value:function(e){if(e){var t=new N;return e.retailerData&&(t.retailerData=I.Create(e.retailerData)),e.impressionId&&(t.impressionId=e.impressionId),t}return new N}},{key:"CountMatchingElements",value:function(t){var r,n=0,o=A(t.split(";"));try{for(o.s();!(r=o.n()).done;){var i=r.value,a=e.CountVisibleElements(i);if(a>0){n=a;break}}}catch(e){o.e(e)}finally{o.f()}return n}},{key:"isElementVisible",value:function(e){return e&&e.offsetWidth>0&&e.offsetHeight>0}},{key:"CountVisibleElements",value:function(t){var r,n=0,o=A(e.RunQuerySelectorAll(t));try{for(o.s();!(r=o.n()).done;){var i=r.value;e.isElementVisible(i)&&n++}}catch(e){o.e(e)}finally{o.f()}return n}},{key:"GetDomainName",value:function(e){if(!e)return"";var t=e.toLowerCase().match(/(w){3}.?\./);return t&&null!=t.index&&t[0]?e.substring(t.index+t[0].length):e}},{key:"inIframe",value:function(){try{return window.self!==window.top}catch(e){return!0}}},{key:"GetFirstVisibleElement",value:function(t){var r,n=A(e.RunQuerySelectorAll(t));try{for(n.s();!(r=n.n()).done;){var o=r.value;if(e.isElementVisible(o))return o}}catch(e){n.e(e)}finally{n.f()}}},{key:"GetBoxValue",value:function(t){if(p.IsValidDataField(t))try{var r=e.GetTextValue(t);return r?r.trim():r}catch(e){throw Error(e.message)}return""}},{key:"getHrefFromHtmlElement",value:function(e){return e?e.getAttribute("href"):""}},{key:"getTextContentFromHtmlElement",value:function(e){if(!e)return"";var t=e.textContent||e.innerText;return t?t.trim():""}},{key:"GetTextValue",value:function(t){var r=t.split(";"),n=e.GetFirstVisibleElement(r[0]),o=n;if(void 0===o)return"";var i=o.innerText;if(1===r.length)i=(o=e.NormalizeIfSuperscripted(n)).innerText;else{var a=e.GetFirstVisibleElement(r[1]);if(a&&a.innerText){var c="."+a.innerText;if(o.contains(a)){var u=o.cloneNode(!0);u.childNodes.forEach((function(e){e.nodeType===Node.ELEMENT_NODE&&u.removeChild(e)})),i=null!=u&&u.innerText?u.innerText:i}i+=c}}return e.StripInvalidJSONCharacters(i)}},{key:"StripInvalidJSONCharacters",value:function(e){return e.replace(/\n/gi,"")}},{key:"NormalizeIfSuperscripted",value:function(e){if(e&&e.innerHTML&&e.innerHTML.toLowerCase().indexOf("</sup>")>-1)try{for(var t=e.cloneNode(!0),r=t.childNodes.length,n=0;n<r;n++){var o=t.childNodes[n];if("SUP"===o.tagName){var i=o.innerText,a=/[0-9\.]+/g.exec(i);if(null!==a)return i="."+a[0],o.innerText=i,t}}}catch(t){return e}return e}},{key:"getOrderStatusFromTextInput",value:function(e){if(!e)return d.ERROR;var t=e.toLowerCase();return t.includes("delivered")?d.DELIVERED:t.includes("arriv")||t.includes("ship")?d.SHIPPED:t.includes("return")?d.RETURNED:t.includes("cancel")?d.CANCELED:d.ORDERED}},{key:"isExpiredDeliveryDate",value:function(e){if(e&&e.toLowerCase().includes("cancel"))return!0;if(!e||isNaN(Date.parse(e)))return!1;var t=e.match(/\d{4}$/g);null!=t&&0!==t.length||(e+=" "+(new Date).getFullYear());var r=new Date(Date.parse(e));return(Date.now()-r.getTime())/864e5>2}},{key:"getOrderDetailsPageForSpecialWebsites",value:function(e,t){return"walmart.com"===e.domainName?"".concat(e.domainName,"/orders/").concat(t):""}},{key:"getOrderNumberForSpecialWebsites",value:function(e,t){if("walmart.com"===e){var r=t.match(/(?<=Order#\s\s*)[\s\S]*?(?=\s*(\|\sTotal))/g);return null!=r&&r.length>0?r[0]:t}return t.startsWith("#")?t.substring(1).trim():t}},{key:"getTotalCostForSpecialWebsites",value:function(e,t){if("walmart.com"===e){var r=t.match(/(?<=Total\s\$\s*)[\s\S]*/g);return null!=r&&r.length>0?r[0]:t}return t}}]),e}(),G=u((function e(){a(this,e),P(this,"orderDate",void 0),P(this,"totalCost",void 0),P(this,"orderNumber",void 0),P(this,"orderDetailsPage",void 0),P(this,"listOfProducts",void 0),P(this,"orderStatus",void 0),P(this,"orderSummary",void 0),P(this,"trackPackageButtonSelector",void 0)})),j=function(){function e(){a(this,e),P(this,"email",void 0),P(this,"orderNumber",void 0),P(this,"phoneNumber",void 0),P(this,"trackingUrl",void 0)}return u(e,null,[{key:"create",value:function(t){var r=new e;return t&&(r.email=t.email,r.orderNumber=t.orderNumber,r.phoneNumber=t.phoneNumber,r.trackingUrl=t.trackingUrl),r}}]),e}(),F=function(){function e(){a(this,e),P(this,"productImageSelector",void 0),P(this,"productUrlSelector",void 0)}return u(e,null,[{key:"create",value:function(t){var r=new e;return t&&(r.productImageSelector=t.productImageSelector,r.productUrlSelector=t.productUrlSelector),r}}]),e}(),U=function(){function e(){a(this,e),P(this,"trackPackageButtonSelector",void 0),P(this,"orderSummarySelector",void 0),P(this,"productContainerSelector",void 0),P(this,"productContentSelector",void 0)}return u(e,null,[{key:"create",value:function(t){var r=new e;if(t){r.trackPackageButtonSelector=t.trackPackageButtonSelector,r.orderSummarySelector=t.orderSummarySelector,r.productContainerSelector=t.productContainerSelector;var n=t.productContentSelector;n&&(r.productContentSelector=F.create(n))}return r}}]),e}(),H=function(){function e(){a(this,e),P(this,"orderDateSelector",void 0),P(this,"totalCostSelector",void 0),P(this,"orderNumberSelector",void 0),P(this,"orderDetailsPageSelector",void 0),P(this,"shipmentContainerSelector",void 0),P(this,"shipmentContentSelector",void 0)}return u(e,null,[{key:"create",value:function(t){var r=new e;if(t){r.orderDateSelector=t.orderDateSelector,r.totalCostSelector=t.totalCostSelector,r.orderNumberSelector=t.orderNumberSelector,r.orderDetailsPageSelector=t.orderDetailsPageSelector,r.shipmentContainerSelector=t.shipmentContainerSelector;var n=t.shipmentContentSelector;n&&(r.shipmentContentSelector=U.create(n))}return r}}]),e}(),M=function(){function e(){a(this,e),P(this,"trackingUrl",void 0),P(this,"clickToOpenOrderSelector",void 0),P(this,"orderContainerSelector",void 0),P(this,"orderContentSelector",void 0)}return u(e,null,[{key:"create",value:function(t){var r=new e;if(t){r.trackingUrl=t.trackingUrl,r.clickToOpenOrderSelector=t.clickToOpenOrderSelector,r.orderContainerSelector=t.orderContainerSelector;var n=t.orderContentSelector;n&&(r.orderContentSelector=H.create(n))}return r}}]),e}(),V=function(){function e(){a(this,e),P(this,"impressionId",void 0),P(this,"domainName",void 0),P(this,"packageTrackingSelectors",void 0)}return u(e,null,[{key:"create",value:function(t){var r=new e;if(t){r.impressionId=t.impressionId,r.domainName=t.domainName;var n=t.packageTrackingSelectors;n&&(r.packageTrackingSelectors=n.map((function(e){return M.create(e)})))}return r}}]),e}(),B=u((function e(){a(this,e),P(this,"productImageUrl",void 0),P(this,"productName",void 0),P(this,"productUrl",void 0)}));function K(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}function q(){return q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=K(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},q.apply(this,arguments)}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return S(this,r)}}var J=function(e){m(r,e);var t=W(r);function r(){return a(this,r),t.apply(this,arguments)}return u(r,[{key:"getMessageType",value:function(){return f.GET_TRACKING_PAGE_DATA.toString()}},{key:"raiseMessageFromHost",value:function(e){var t=e.shift();if(t&&t===this.getMessageType())try{"interactive"===document.readyState||"complete"===document.readyState?window.getTrackingPageData(e):window.addEventListener&&window.addEventListener("DOMContentLoaded",(function(t){window.checkAndGetTrackingPageData(e)}))}catch(e){}}},{key:"postMessageToHost",value:function(e,t){q(w(r.prototype),"postMessageToHost",this).call(this,e,t,trackingPageValidatorNativeHandler)}}]),r}(function(){function e(){a(this,e)}return u(e,[{key:"raiseMessageFromHost",value:function(e,t,r){var n=e.shift();if(n&&n===this.getMessageType())try{"interactive"===document.readyState||"complete"===document.readyState?t(e,!0):window.addEventListener&&window.addEventListener("DOMContentLoaded",(function(t){r(e,!0)}))}catch(e){}}},{key:"postMessageToHost",value:function(e,t,r){try{r&&r.sendMessageToHost(e,t)}catch(e){}}},{key:"initialize",value:function(e,t,r){e.splice(0,2);try{"interactive"===document.readyState||"complete"===document.readyState?t(e,!1):window.addEventListener&&window.addEventListener("DOMContentLoaded",(function(t){r(e,!1)}))}catch(e){return!1}return!0}}]),e}());function Q(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return $(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var z="",Y=!1,X="";function Z(e){return ee.apply(this,arguments)}function ee(){return(ee=t(o().mark((function e(r){var n,a,c,u,l,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="",e.prev=1,z=r[2],Y="true"===r[3].toLowerCase(),X="",c=JSON.parse(r[0]),u=V.create(c),l=JSON.parse(r[1]),s=l?l.filter((function(e){var t;return!i(null!==(t=null==e?void 0:e.orderNumber)&&void 0!==t?t:"")})).map((function(e){return j.create(e)})):[],n=null!==(a=null==u?void 0:u.impressionId)&&void 0!==a?a:"",e.next=12,p.WaitForCondition(t(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te(u));case 1:case"end":return e.stop()}}),e)}))),5e3).then((function(e){e?ie(n,u,s):oe(n,new C("Invalid page"),u)})).catch((function(e){oe(n,e,u)}));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),oe(n,e.t0,null);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})))).apply(this,arguments)}function te(e){var t=null==e?void 0:e.packageTrackingSelectors;if(!t){throw new C("Invalid package tracking selectors")}var r,n=window.location.href.toString(),o=!1,i="",a=Q(t);try{for(a.s();!(r=a.n()).done;){var c=r.value;if(c.trackingUrl&&n.includes(c.trackingUrl)&&c.orderContainerSelector){o=!0,i=c.orderContainerSelector;break}}}catch(e){a.e(e)}finally{a.f()}if(!o){throw new C("Invalid Order Page URL")}return!!document.querySelector(i)}function re(e){return!Y||!i(e)&&(i(X)?(X=e,!0):X===e)}function ne(e,t){var r,n=L.getTextContentFromHtmlElement(e);return i(n)?null!==(r=null==t?void 0:t.getAttribute("alt"))&&void 0!==r?r:"":n}function oe(e,t,r){var n,o=f.TRACKING_PAGE_SCRIPT_ERROR,i=null!==(n=null==t?void 0:t.message)&&void 0!==n?n:"";t instanceof SyntaxError?o=f.TRACKING_PAGE_PARSING_ERROR:t instanceof C&&(o=f.INVALID_TRACKING_PAGE_ERROR),function(e,t,r,n){var o={domain:L.GetDomainName(window.location.hostname),pageUrl:window.location.toString(),retailerData:JSON.stringify(n)},i=ae(e,f.TRACKING_PAGE_ERROR,r,o);i&&t&&(i.ErrorType=t);ce(i)}(e,o,i,r),window.trackingPageValidatorRuntime.postMessageToHost(o,[i,z])}function ie(e,t,r){var n=new Set;null!=r&&r.length&&(n=new Set(r.map((function(e){return e.orderNumber}))));var o=function(e,t){var r=[],n=null==e?void 0:e.packageTrackingSelectors;if(!n)return r;var o,a=Q(n);try{for(a.s();!(o=a.n()).done;){var c,u,l=o.value,s=null!==(c=null==l?void 0:l.clickToOpenOrderSelector)&&void 0!==c?c:"";if(!i(s))for(var f=L.RunQuerySelectorAll(s),d=1;d<f.length;d++)f[d].click();var v,p=null!==(u=null==l?void 0:l.orderContainerSelector)&&void 0!==u?u:"",h=Q(L.RunQuerySelectorAll(p));try{for(h.s();!(v=h.n()).done;){var y,m,g,S,w,b,k=v.value,E=null==l||null===(y=l.orderContentSelector)||void 0===y?void 0:y.shipmentContainerSelector;if(E){var T=null!==(m=null==l||null===(g=l.orderContentSelector)||void 0===g?void 0:g.orderNumberSelector)&&void 0!==m?m:"",C=k.querySelector(T),P=L.getTextContentFromHtmlElement(C),D=L.getOrderNumberForSpecialWebsites(null==e?void 0:e.domainName,P);if(!((null==t?void 0:t.size)>0)||null!=t&&t.has(D)){var O=null==l||null===(S=l.orderContentSelector)||void 0===S?void 0:S.orderDateSelector,x=O?k.querySelector(O):null,R=L.getTextContentFromHtmlElement(x);if(re(R)){var I,N=null==l||null===(w=l.orderContentSelector)||void 0===w?void 0:w.totalCostSelector,A=N?k.querySelector(N):null,_=L.getTextContentFromHtmlElement(A),j=L.getTotalCostForSpecialWebsites(null==e?void 0:e.domainName,_),F=null==l||null===(b=l.orderContentSelector)||void 0===b?void 0:b.orderDetailsPageSelector,U=F?k.querySelector(F):null,H=U?L.getHrefFromHtmlElement(U):L.getOrderDetailsPageForSpecialWebsites(e,D),M=Q(k.querySelectorAll(E));try{for(M.s();!(I=M.n()).done;){var V,K,q,W=I.value,J=[],$=null==l||null===(V=l.orderContentSelector)||void 0===V?void 0:V.shipmentContentSelector,z=null!==(K=null==$?void 0:$.trackPackageButtonSelector)&&void 0!==K?K:"",Y=null==$?void 0:$.orderSummarySelector,X=null!==(q=null==$?void 0:$.productContainerSelector)&&void 0!==q?q:"",Z=Y?W.querySelector(Y):null,ee=L.getTextContentFromHtmlElement(Z),te=L.getOrderStatusFromTextInput(ee);if(!L.isExpiredDeliveryDate(ee)){var oe,ie=Q(W.querySelectorAll(X));try{for(ie.s();!(oe=ie.n()).done;){var ae,ce=oe.value,ue=null==$?void 0:$.productContentSelector,le=null==ue?void 0:ue.productImageSelector,se=null==ue?void 0:ue.productUrlSelector,fe=le?ce.querySelector(le):null,de=null!==(ae=null==fe?void 0:fe.src)&&void 0!==ae?ae:"",ve=se?ce.querySelector(se):null,pe=ne(ve,fe);if(!i(de)||!i(pe)){var he=Object.assign(new B,{productImageUrl:de,productName:pe,productUrl:L.getHrefFromHtmlElement(ve)});J.push(he)}}}catch(e){ie.e(e)}finally{ie.f()}if(null!=J&&J.length){var ye=Object.assign(new G,{listOfProducts:J,orderDate:R,orderDetailsPage:H,orderNumber:D,orderStatus:te,orderSummary:ee,totalCost:j,trackPackageButtonSelector:z});r.push(ye)}}}}catch(e){M.e(e)}finally{M.f()}}}}}}catch(e){h.e(e)}finally{h.f()}}}catch(e){a.e(e)}finally{a.f()}return r}(t,n);!function(e,t,r){var n={domain:L.GetDomainName(window.location.hostname),numOfOrders:r};ce(ae(e,f.TRACKING_PAGE_DATA,t,n))}(e,"Successful order history page extraction",o.length),window.trackingPageValidatorRuntime.postMessageToHost(f.TRACKING_PAGE_DATA,[JSON.stringify(o),z])}function ae(e,t,r,n){var o={};return o.JsonData=JSON.stringify(n),o.EventType=t,o.LogLevel="Information",o.Message=r,o.ClientContext={AppInfoClientName:"Edge",JSVersion:"1.1"},e&&(o.ImpressionId=e),o}function ce(e){var t=[JSON.stringify(e)];window.trackingPageValidatorRuntime.postMessageToHost("LogScriptTelemetry",t)}window.checkAndGetTrackingPageData=function(e){L.inIframe()||Z(e)},window.getTrackingPageData=Z;var ue=new J;window.trackingPageValidatorRuntime=ue}()}();